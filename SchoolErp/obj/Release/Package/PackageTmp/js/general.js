function getactivetab(e) { $(".tab-pane").removeClass("active"), $(".nav-tabs li").removeClass("active"), $("#" + e).addClass("active"), $("#" + e + "Li").addClass("active") } function scrollToTop() { $(window).scroll(function () { $(this).scrollTop() > 100 ? ($(".scrollup").fadeIn(), $(".scrollupText").fadeIn()) : ($(".scrollup").fadeOut(), $(".scrollupText").fadeOut()) }), $(".scrollup").click(function () { return $("html, body").animate({ scrollTop: 0 }, 600), !1 }), $(document).keydown(function (e) { if (113 == e.keyCode) return $("html, body").animate({ scrollTop: 0 }, 600), !1 }) } function highlightmenu(e) { if (void 0 !== e); else e = $("#highlightLeftMenu").length > 0 ? $.trim($("#highlightLeftMenu").html()) : ""; "" != e && ($(".sidebar-menu .treeview", window.parent.document).removeClass("active"), $(".sidebar-menu .treeview a", window.parent.document).removeClass("active"), $(".sidebar-menu .treeview-menu", window.parent.document).css({ display: "none" }), $(".sidebar-menu #" + e, window.parent.document).parent().parent().css({ display: "block" }), $(".sidebar-menu #" + e, window.parent.document).closest(".treeview").addClass("active"), $(".sidebar-menu #" + e, window.parent.document).addClass("active"), $(".sidebar-menu .treeview > a > i.pull-right", window.parent.document).removeClass("fa-angle-down"), $(".sidebar-menu .treeview.active > a > i.pull-right", window.parent.document).removeClass("fa-angle-left"), $(".sidebar-menu .treeview.active > a > i.pull-right", window.parent.document).addClass("fa-angle-down")) } function highLightmenu(e) { $("#projectsUL li").removeAttr("class"), document.getElementById(e).setAttribute("class", "projectSelected") } function testParentWindow() { return self != window.parent } function testParentParentWindow() { return self != window.parent.window.parent && self != window.parent } function showScsMsg(e) { hideProcess(), highlightmenu(), $("." + e).attr("style", "display:block"), "scsErr" == e && setTimeout(function () { $("." + e).fadeOut(), $(".errMsg").attr("style", "display:none"), $(".scsErr").attr("style", "display:none") }, 2e3) } function showScsMsgWithMsg(e, t) { var n = window.document; 0 == $("#processing").length && testParentWindow() && (n = window.parent.document), $("." + t + " msg", n).html(e), $(".errMsg", n).attr("style", "display:block"), "scsErr" == t ? ($(".scsErr", n).attr("style", "display:block"), $(".warningErr", n).attr("style", "display:none"), setTimeout(function () { $(".scsErr", n).fadeOut(), $(".errMsg", n).attr("style", "display:none") }, 3e3)) : ($(".warningErr", n).attr("style", "display:block"), $(".scsErr", n).attr("style", "display:none")) } function showScsMsgWithTab(e, t) { highlightmenu(), showScsMsg(e), tabToShow(t) } function hideMsg() { $(".scsErr").fadeOut(), $(".warningErr").fadeOut(), $(".errMsg").attr("style", "display:none") } function showProcess(e) { $("#processing").length > 0 && (document.getElementById("processing").innerHTML = "&nbsp;&nbsp;&nbsp;" + e + "&nbsp;&nbsp;&nbsp;", document.getElementById("processing").setAttribute("class", "show")) } function hideProcess() { $("#processing").length > 0 && ($(".errMsg").attr("style", "display:none"), document.getElementById("processing").innerHTML = "", document.getElementById("processing").setAttribute("class", "hide")), testParentWindow() || $("#processing").length > 0 && ($(".errMsg").attr("style", "display:none"), document.getElementById("processing").innerHTML = "", document.getElementById("processing").setAttribute("class", "hide")), testParentWindow && $("#processing", window.parent.document).length > 0 && ($(".errMsg", window.parent.document).attr("style", "display:none"), window.parent.document.getElementById("processing").innerHTML = "", window.parent.document.getElementById("processing").setAttribute("class", "hide")) } function getControlValue(e, t) { var n = ""; if (void 0 === t && (t = !1), t) { if ($(e).length > 0) { var o = $(e), a = $(e).attr("formatcurrency"), i = o[0].tagName.toLowerCase(); if ("input" == i) { var r = o[0].type.toLowerCase(); n = "checkbox" == r || "radio" == r ? $(e).is(":checked") : $.trim($(o).val()) } else n = "select" == i || "textarea" == i ? $.trim($(o).val()) : $.trim($(o).html()); void 0 !== a && (n = n.replaceAll("$", "").replaceAll(",", "").trim()) } } else if ($("#" + e).length > 0) { var o = $("#" + e), a = $("#" + e).attr("formatcurrency"); n = "input" == (i = o[0].tagName.toLowerCase()) ? "checkbox" == (r = o[0].type.toLowerCase()) || "radio" == r ? $("#" + e).is(":checked") : $.trim($(o).val()) : "select" == i || "textarea" == i ? $.trim($(o).val()) : $.trim($(o).html()), void 0 !== a && (n = n.replaceAll("$", "").replaceAll(",", "").trim()) } return n } function setControlValue(e, t, n) { if (void 0 === n && (n = !1), n) { if ($(e).length > 0) { var o = $(e), a = o[0].tagName.toLowerCase(); if ("input" == a) { var i = o[0].type.toLowerCase(); "checkbox" == i || "radio" == i ? o.checked = Boolean(t) : $(o).val(t) } else "select" == a ? $(o).val(t) : $(o).html(t) } } else $("#" + e).length > 0 && ("input" == (a = (o = $("#" + e))[0].tagName.toLowerCase()) ? "checkbox" == (i = o[0].type.toLowerCase()) || "radio" == i ? "true" == t.toString().toLowerCase() ? $("#" + e).prop("checked", !0) : $("#" + e).prop("checked", !1) : $(o).val(t) : "select" == a ? $(o).val(t) : $(o).html(t)) } function getControlValueByAttr(e, t) { var n = "", o = t; if (-1 == t.indexOf(" ") && (o = " [" + o + "]"), "" != e && (e = "#" + e), $(e + o).length > 0) { var a = $(e + o), i = a[0].tagName.toLowerCase(); n = "input" == i ? "checkbox" == a[0].type.toLowerCase() ? $("#" + id).is(":checked") : $.trim($(a).val()) : "select" == i || "textarea" == i ? $.trim($(a).val()) : $.trim($(a).html()) } return n } function setControlValueByAttr(e, t, n) { if ($("#" + e + " [" + t + "]").length > 0) { var o = $("#" + e + " [" + t + "]"), a = o[0].tagName.toLowerCase(); "input" == a ? "checkbox" == o[0].type.toLowerCase() ? $(o).prop("checked", !0) : $(o).val(n) : "select" == a ? $(o).val(n) : $(o).html(n) } } function createDragTblRowsDynamicallyViaTemplete(e, t, n, o) { var a = $("#" + t + " > tbody > tr ").length; $("#" + t + " > tbody > tr").each(function () { var e = parseInt($(this).attr("rownumber")); e > a && (a = e) }); var r = $("#" + e).html(), l = t.replace("tbl", "tr"); for (i = 1; i <= n; i++) { var s = i + parseInt(a), c = l + "_" + s, d = "<tr id='" + c + "' rowNumber='" + s + "' >" + r.replace(new RegExp("@rowId", "g"), c) + "</tr>"; $("#" + t).append(d), $("#" + c + " select[parentDDLId]").each(function () { var e = $(this).attr("id"), t = $(this).attr("parentddlid"); createDDLFromAnotherDDLShowSelected(e, t, !0) }) } o && bindDragAndDrop() } function bindDragAndDrop() { $("[tblShallDragDrop]").tableDnD({ onDragClass: "myDragClass", onDrop: function (e, t) { for (var n = e.tBodies[0].rows, o = 0; o < n.length; o++) debugStr += n[o].id + " "; $("#debugArea").html(debugStr) }, onDragStart: function (e, t) { } }) } function bindMask() { $("input[mask='phone']").mask("(999) 999-9999") } function bindPhoneMask(e) { $("#" + e).mask("(999) 999-9999") } function deleteConfirm(e, t) { return !!confirm(e) && (showProcess(t), !0) } function getNumbersFromString(e) { return e.replace(/\D/g, "") } function makeDefaultButtonInDiv(e, t, n) { "13" == t.keyCode && $(e).find("#" + n).click() } function showDivInModapPopUp(e) { $(".modal-content > [showHide] ").addClass("hide"), $(".modal-content #" + e).removeClass("hide") } function ReloadPageRemoveQueryStr() { window.location = window.location.split("?")[0] } function loadDataForGridViewInPage(e, t) { showProcess("Loading..."); getWindowLocation(); if ($(".sidebar-menu > li").removeClass("active"), $(".sidebar-menu a").removeClass("active"), $(".sidebar-menu #" + e).length > 0 && ($(".sidebar-menu .treeview-menu").css({ display: "none" }), $(".sidebar-menu #" + e).parent().parent().css({ display: "block" }), $(".sidebar-menu #" + e).parent().parent().parent().addClass("active"), $(".sidebar-menu #" + e).addClass("active")), void 0 !== t) { var n = document.getElementById("iframeDefault"); n.contentWindow ? n = n.contentWindow : n.window ? n = n.window : n.contentDocument ? n = n.contentDocument : n.document && (n = n.document), n.loadGrdVmrTableInChildFrame(t) } } function loadGrdVmrTableInChildFrame(e) { $("[content]").html(""), $("[content]").css({ "min-height": "0", display: "none" }), $("#modalMsg.showmodal").length > 0 && $(".clsoeBtnDiv img").click(), loadDataForGridView(e) } function loadGrdVmrTableFromChildFrame(e, t) { highlightmenu(t), loadGrdVmrTableInChildFrame(e) } function loadIframePage(e, t, n) { showProcess("Loading..."); var o = t, a = getWindowLocation(), i = a + "/" + t; if ($(".sidebar-menu > li").removeClass("active"), $(".sidebar-menu a").removeClass("active"), $(".sidebar-menu #" + e).length > 0) { var r = $("#iframe" + e).attr("src"); o.length, r != i && o.length > 2 && $("#iframe" + e).attr("src", i), $(".sidebar-menu .treeview-menu").css({ display: "none" }), $(".sidebar-menu #" + e).parent().parent().css({ display: "block" }), $(".sidebar-menu #" + e).parent().parent().parent().addClass("active"), $(".sidebar-menu #" + e).addClass("active") } i = a + "/" + t; $("#iframeDefault").attr("src", i) } function loadIframePageInParent(e, t) { var n = getWindowLocation(); self == window.parent ? window.location.href = n + "/" + t : window.parent.loadIframePage(e, t) } function loadIframePageInParentsParent(e, t) { getWindowLocation(); loadIframePageInParent(e, t) } function getfunctionNameFromFunction(e) { t = ""; if (void 0 !== e) var t = e.toString(); return t = t.substr("function ".length), t = t.substr(0, t.indexOf("(")) } function getWindowLocation() { var e = window.location.origin; return window.location.origin || (e = window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "")), e } function testIfAccountNumberExist(e, t, n, o, a) { var i = getControlValue("txtAccountToSrch"), r = getNumbersFromString(i); if (i == r) { var l = "{'" + n + "':'" + r + "'}"; callServiceMethod(l, e, t, successMethodAfterInsertUpdate, "", "", !1, "", !0, getAccoutDetailFromAccountNumber_Scs, r, o, a) } else "" != (r = getControlValue("txtAccountToSrch_No")) ? window.location.href = o + r : alert(a + " does not Exists...") } function getAccoutDetailFromAccountNumber_Scs(e, t, n, o) { o.d ? window.location.href = t + e : alert(n + " Number does not Exist...") } function autoCompleteTextBoxWS(e, t, n, o, a, i, r, l, s) { $("#" + o).autocomplete({ source: function (a, i) { var r = new Object; r.Location = $("#" + o), r.City = $("#ddlCities"); var l = "{'" + t + "':" + JSON.stringify(r) + "}"; $.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: e, data: l, dataType: "json", success: function (e) { i(n ? $.map(e.d, function (e) { return { label: e.split("***")[0], val: e.split("***")[1] } }) : $.map(e.d, function (e) { return { label: e } })), $("#ui-id-1").attr("style", "z-index:9999;top: 55px; left: 335.156px; width: 343px;") }, error: function (e) { alert(e.responseText) }, failure: function (e) { alert(e.responseText) } }) }, select: function (e, t) { void 0 === a && "" == a || setControlValue(a, t.item.val), i && (void 0 !== t.item.val ? r(t.item.val, l, s) : r(t.item.label, l, s)) } }) } function autoCompleteTextBoxXml(e, t, n, o, a, i, r, l, s, c) { $.ajax({ url: e, dataType: "xml", success: function (e) { var d = $(t, e).map(function () { return { value: $(n, this).text(), id: $(o, this).text() } }).get(); $("#" + a).autocomplete({ source: d, minLength: 1, select: function (e, t) { setControlValue(i, t.item.id), r && l(t.item.id, s, c) } }) } }) } function autoCompleteTxtFile(e, t, n, o, a, i) { $.get(t, function (t) { var r = jQuery.parseJSON(t); $(n).autocomplete({ source: r, minLength: e, select: function (e, t) { "" != o && o(t.item.value, a, i) } }) }) } function getQuerystring(e) { if (window.location.search.length > 0) { for (var t = window.location.search.substring(1).split("&"), n = null, o = "", a = 0; a < t.length; a++) { var i = t[a].split("="); i[0] == e && (n = i[1]) } return n } return o } function filterArray(e, t) { return e.filter(function (e) { return Object.keys(t).every(function (n) { return e[n] == t[n] }) }) } function isValueBool(e) { if ("1" == (e = e.toString().trim().toLowerCase()) || "true" == e) return !0 } function selectTblVMRRow(e) { $("#" + e).closest("tbody").find("tr").removeClass("trSelected"), $("#" + e).addClass("trSelected") } function clearAfterSaveByRitin(e) { $("#" + e).length > 0 && $("#" + e + " input,select").each(function () { var e = $(this), t = e[0].tagName.toLowerCase(); if ("input" == t) "checkbox" == e[0].type.toLowerCase() || ($(this).attr("value") ? this.value = $(this).attr("value") : this.value = ""); else if ("select" == t || "textarea" == t) { if ($(this).parent().children("ddlvalue").length > 0) { var n = $(this).parent().children("ddlvalue").html(); alert(n), $(this).val(n) } } else $(e).html("") }) } function formatData() { $("[formatCurrency]").each(function () { var e = "", t = "$"; void 0 !== $(this).attr("nd") && (t = ""), "input" == $(this)[0].tagName.toLowerCase() ? (e = $.trim($(this).val()), $(this).val(e.formatMoney(t, 2, ",", "."))) : (e = $.trim($(this).html()), $(this).html(e.formatMoney(t, 2, ",", "."))) }), $("[formatDateTime]").each(function () { var e = $(this).attr("formatDateTime"), t = getControlValue(this, !0); null === t && "" == t || setControlValue(this, t.formatDateTimeWithParameter(e), !0) }), $("[formatPhone]").each(function () { var e = ""; "input" == $(this)[0].tagName.toLowerCase() ? (e = (e = $.trim($(this).val())).replace(/(\d{3})(\d{3})(\d{4})/, "($1) $2-$3"), $(this).val(e)) : (e = (e = $.trim($(this).html())).replace(/(\d{3})(\d{3})(\d{4})/, "($1) $2-$3"), $(this).html(e)) }) } function loadCompaniesInDdl() { callServiceMethod("", "../../Admin/Default.aspx", "getCompanyName", "", "", "", !1, "", !0, loadCompaniesInDdl_Scs, "", "", "") } function loadCompaniesInDdl_Scs(e, t, n, o) { bindDdlWithData("ddlCompanies", o.d, "ID", "CompanyName", !1, "", "") } function selectRow(e, t) { void 0 === t && (t = !1), t ? $("#" + e).find("input[type=checkbox][chk]").is(":checked") ? $("#" + e).find("input[type=checkbox][chk]").prop("checked", !1) : $("#" + e).find("input[type=checkbox][chk]").prop("checked", !0) : $("#" + e).find("input[type=checkbox][chk]").is(":checked") ? ($("#" + e).find("input[type=checkbox][chk]").prop("checked", !1), $("#" + e).removeClass("trSelected")) : ($("#" + e).find("input[type=checkbox][chk]").prop("checked", !0), $("#" + e).addClass("trSelected")) } function sendEmailFromTopMenu() { var e = 0; if ($("#ddlContact").length > 0) e = $("#ddlContact").val().trim(); else if ($("[contactnumber]:first-child").length > 0) { var t = $("[contactnumber]:first-child"); e = "select" == t[0].tagName.toLowerCase() ? $.trim($(t).val()) : $(".trSelected [contactnumber]").html().trim() } if ("" != e && 0 != e) showMdlLoadIframe("Sitepages/SM/Email.aspx?contactnumber=" + e, "Compose Email", 660, 820); else { var n = 0; $(".trSelected [accountNUmber]").length > 0 && (n = $(".trSelected [accountNUmber]").html().trim()), "" != n && 0 != n ? showMdlLoadIframe("Sitepages/SM/Email.aspx?accountNumber=" + n, "Compose Email", 660, 820) : showMdlLoadIframe("Sitepages/SM/Email.aspx", "Compose Email", 660, 820) } } function makeAccountAnchor(e, t) { var n = window.location.origin; window.location.origin || (n = window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : ""), n = path), "" != e && "" != t ? $("#" + e).attr("href", n + "/SitePages/Accounts/AddAccount.aspx?id=" + t) : $("#ancAccount").attr("href", "javascript:void(0)") } function concateDateTime(e, t) { var n = ""; return "" != getControlValue(e) && (n = getControlValue(e), "" != getControlValue(t) && (n = getControlValue(e) + " " + getControlValue(t))), n } function showBtnAfterInsert(e) { var t = getControlValue(e); "0" != t && "" == t ? $("[afterIns]").addClass("hide") : $("[afterIns]").removeClass("hide") } function confirmVMR(e, t, n, o, a, i, r, l) { void 0 === r && (r = ""), void 0 === l && (l = "Confirm"), swal({ title: e, text: r, type: "warning", showCancelButton: !0, confirmButtonColor: "#dd1533", confirmButtonText: l, closeOnConfirm: !0, closeOnCancel: !0 }, function (e) { e && t(n, o, a, i) }) } function alertVMR(e, t) { void 0 === t && (t = ""), swal({ title: e, text: t, type: "warning" }) } function getMultiDddlValue(e) { var t = "", n = $("#" + e).val(); if (null != n && n.indexOf("multiselect-all") > -1 && (n = n.toString().replaceAll("multiselect-all", "")), null != n && -1 == n.indexOf("multiselect-all")) { var o = n.toString().split(",").length, a = n.toString().split(","); if (t = "", o > 1) { for (i = 0; i < o; i++) "" != a[i] && (t = t + "," + a[i]); t = t.substring(1) } else t = n[0] } return "" == t && (t = null), t } $(document).ready(function () { $("[defaultFocus]:first").length > 0 && $("[defaultFocus]:first").focus(), attachValidation(), highlightmenu() });